{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/zhaoolee/github/DualTime/app/components/Compass.js"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\n\nexport default function Compass() {\n  const [heading, setHeading] = useState(0)\n  const [error, setError] = useState(null)\n  const [permissionState, setPermissionState] = useState('prompt')\n  const [isInitialized, setIsInitialized] = useState(false)\n\n  const handleOrientation = (event) => {\n    // For iOS devices - uses webkitCompassHeading\n    if (event.webkitCompassHeading) {\n      setHeading(event.webkitCompassHeading)\n    }\n    // For Android devices - calculate from alpha angle\n    else if (event.alpha) {\n      setHeading(360 - event.alpha)\n    }\n  }\n\n  const initializeCompass = () => {\n    try {\n      window.addEventListener('deviceorientation', handleOrientation, true)\n      setIsInitialized(true)\n      setPermissionState('granted')\n    } catch (err) {\n      setError('初始化指南针失败')\n      setPermissionState('denied')\n    }\n  }\n\n  useEffect(() => {\n    // 如果不需要请求权限（Android和旧版iOS），直接初始化\n    if (typeof DeviceOrientationEvent.requestPermission !== 'function') {\n      if (typeof DeviceOrientationEvent === 'undefined') {\n        setError('设备方向API不可用')\n        return\n      }\n      initializeCompass()\n    }\n\n    return () => {\n      window.removeEventListener('deviceorientation', handleOrientation, true)\n    }\n  }, [])\n\n  const getDirectionInfo = (heading) => {\n    const directions = [\n      { text: '北', element: '水', animal: '玄武', color: 'text-blue-600' },\n      { text: '东北', element: '土', animal: '螣蛇', color: 'text-yellow-700' },\n      { text: '东', element: '木', animal: '青龙', color: 'text-green-600' },\n      { text: '东南', element: '木', animal: '朱雀', color: 'text-red-600' },\n      { text: '南', element: '火', animal: '朱雀', color: 'text-red-600' },\n      { text: '西南', element: '土', animal: '勾陈', color: 'text-yellow-700' },\n      { text: '西', element: '金', animal: '白虎', color: 'text-gray-600' },\n      { text: '西北', element: '金', animal: '饕餮', color: 'text-gray-600' }\n    ]\n    const index = Math.round(heading / 45) % 8\n    return directions[index]\n  }\n\n  const handlePermissionRequest = async () => {\n    try {\n      // 直接在点击事件中请求权限\n      const permission = await DeviceOrientationEvent.requestPermission()\n      if (permission === 'granted') {\n        initializeCompass()\n      } else {\n        throw new Error('需要访问设备方向的权限')\n      }\n    } catch (err) {\n      setError(err.message)\n      setPermissionState('denied')\n    }\n  }\n\n  if (error) {\n    return (\n      <div className=\"flex flex-col items-center space-y-3 sm:space-y-4\">\n        <div className=\"w-[160px] h-[160px] sm:w-[200px] sm:h-[200px] md:w-[240px] md:h-[240px] lg:w-[280px] lg:h-[280px] xl:w-[320px] xl:h-[320px] 2xl:w-[360px] 2xl:h-[360px] bg-gray-100 rounded-full flex items-center justify-center p-4 text-center\"\n             style={{ maxWidth: 'min(40vw, 50vh)', maxHeight: 'min(40vw, 50vh)' }}>\n          <div className=\"text-gray-500 text-xs sm:text-sm\">{error}</div>\n        </div>\n      </div>\n    )\n  }\n\n  if (!isInitialized && typeof DeviceOrientationEvent.requestPermission === 'function') {\n    return (\n      <div className=\"flex flex-col items-center space-y-3 sm:space-y-4\">\n        <div \n          className=\"w-[160px] h-[160px] sm:w-[200px] sm:h-[200px] md:w-[240px] md:h-[240px] lg:w-[280px] lg:h-[280px] xl:w-[320px] xl:h-[320px] 2xl:w-[360px] 2xl:h-[360px] bg-gray-100 rounded-full flex items-center justify-center p-4 text-center\"\n          style={{ maxWidth: 'min(40vw, 50vh)', maxHeight: 'min(40vw, 50vh)' }}\n        >\n          <div className=\"flex flex-col items-center space-y-4\">\n            <svg className=\"w-8 h-8 sm:w-10 sm:h-10 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z\" />\n            </svg>\n            <div className=\"text-gray-500 text-xs sm:text-sm text-center mb-2\">\n              需要访问设备方向\n            </div>\n            <button\n              onClick={handlePermissionRequest}\n              className=\"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-full text-sm font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2\"\n            >\n              允许访问\n            </button>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  const directionInfo = getDirectionInfo(heading)\n\n  return (\n    <div className=\"flex flex-col items-center space-y-3 sm:space-y-4\">\n      <div className=\"compass-dial w-[160px] h-[160px] sm:w-[200px] sm:h-[200px] md:w-[240px] md:h-[240px] lg:w-[280px] lg:h-[280px] xl:w-[320px] xl:h-[320px] 2xl:w-[360px] 2xl:h-[360px] bg-white rounded-full relative shadow-xl\"\n           style={{ maxWidth: 'min(40vw, 50vh)', maxHeight: 'min(40vw, 50vh)' }}>\n        {/* 背景图案 - 八卦纹 */}\n        <div className=\"absolute inset-0 rounded-full border-8 border-gray-100 bg-gradient-to-br from-gray-50 to-white\"\n             style={{ backgroundImage: \"url(\\\"data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M50 50 L50 0 A50 50 0 0 1 100 50 Z' fill='%23f3f4f6'/%3E%3Cpath d='M50 50 L100 50 A50 50 0 0 1 50 100 Z' fill='%23e5e7eb'/%3E%3Cpath d='M50 50 L50 100 A50 50 0 0 1 0 50 Z' fill='%23f3f4f6'/%3E%3Cpath d='M50 50 L0 50 A50 50 0 0 1 50 0 Z' fill='%23e5e7eb'/%3E%3C/svg%3E\\\")\" }}>\n        </div>\n        \n        <div className=\"absolute inset-0 flex items-center justify-center\">\n          <div className=\"relative w-full h-full\">\n            {/* 方位标记 */}\n            <div className=\"absolute inset-0 flex items-center justify-center\"\n                 style={{ transform: `rotate(${-heading}deg)` }}>\n              <div className=\"w-full h-full border-4 border-gray-200 rounded-full flex items-center justify-center\">\n                {/* 北方 - 红色 */}\n                <div className=\"absolute top-0 left-1/2 -translate-x-1/2 w-1 h-8 bg-red-500\"></div>\n                {/* 其他方位 - 灰色 */}\n                <div className=\"absolute bottom-0 left-1/2 -translate-x-1/2 w-1 h-6 bg-gray-300\"></div>\n                <div className=\"absolute left-0 top-1/2 -translate-y-1/2 h-1 w-6 bg-gray-300\"></div>\n                <div className=\"absolute right-0 top-1/2 -translate-y-1/2 h-1 w-6 bg-gray-300\"></div>\n                \n                {/* 八卦方位文字 */}\n                <div className=\"absolute top-2 left-1/2 -translate-x-1/2 -translate-y-full text-sm font-bold text-red-600\">北</div>\n                <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 translate-y-full text-sm font-bold text-blue-600\">南</div>\n                <div className=\"absolute left-2 top-1/2 -translate-y-1/2 -translate-x-full text-sm font-bold text-green-600\">西</div>\n                <div className=\"absolute right-2 top-1/2 -translate-y-1/2 translate-x-full text-sm font-bold text-yellow-600\">东</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div className=\"text-center space-y-2\">\n        <div className={`text-lg sm:text-2xl lg:text-3xl xl:text-4xl font-bold mb-1 sm:mb-2 ${directionInfo.color}`}>\n          {Math.round(heading)}° {directionInfo.text}\n        </div>\n        <div className=\"text-sm space-y-1\">\n          <div className=\"text-gray-600\">\n            五行：<span className={directionInfo.color}>{directionInfo.element}</span>\n          </div>\n          <div className=\"text-gray-600\">\n            神兽：<span className={directionInfo.color}>{directionInfo.animal}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n} "],"names":[],"mappings":"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"}},
    {"offset": {"line": 419, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}