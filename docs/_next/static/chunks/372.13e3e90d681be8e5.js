"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[372],{4372:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});var r=s(5880),a=s(6292);function l(){let[e,t]=(0,a.useState)(0),[s,l]=(0,a.useState)(null),[d,i]=(0,a.useState)("prompt"),[n,o]=(0,a.useState)(!1),[c,m]=(0,a.useState)(!1),[x,u]=(0,a.useState)(0),[h,f]=(0,a.useState)(0),b=(0,a.useRef)(0),v=e=>{let s=Date.now();if(s-x<100)return;let r=0;if(e.webkitCompassHeading?r=e.webkitCompassHeading:e.alpha&&(r=360-e.alpha),0===b.current){b.current=r,t(Math.round(r)),f(r),u(s);return}let a=r-(b.current%360+360)%360;a>180?a-=360:a<-180&&(a+=360),Math.abs(a)>2&&(b.current+=a,t(Math.round(r)),f(b.current)),u(s)},j=()=>{try{window.addEventListener("deviceorientation",v,!0),o(!0),i("granted")}catch(e){l("天地磁场感应受阻，罗盘启动失败"),i("denied")}};if((0,a.useEffect)(()=>(m(!0),"undefined"!=typeof DeviceOrientationEvent?"function"!=typeof DeviceOrientationEvent.requestPermission&&j():l("此处天机不显，方位感应术法不可用"),()=>{window.removeEventListener("deviceorientation",v,!0)}),[]),!c)return(0,r.jsx)("div",{className:"flex flex-col items-center space-y-4",children:(0,r.jsxs)("div",{className:"compass-dial w-48 h-48 sm:w-56 sm:h-56 relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-full"}),(0,r.jsx)("div",{className:"absolute inset-2 bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-full border-2 border-emerald-400 flex items-center justify-center shadow-lg",children:(0,r.jsxs)("div",{className:"text-emerald-700 text-sm font-medium text-center px-4",children:[(0,r.jsx)("div",{className:"mb-2",children:"\uD83E\uDDED"}),(0,r.jsx)("div",{children:"玄机罗盘启动中..."}),(0,r.jsx)("div",{className:"text-xs mt-1 opacity-80",children:"正在感应天地磁场"})]})})]})});let g=async()=>{console.log("Permission request button clicked");try{if("https:"!==location.protocol&&"localhost"!==location.hostname)throw Error("需要在HTTPS环境下使用指南针功能");if("undefined"==typeof DeviceOrientationEvent)throw Error("设备方向API不可用");if("function"!=typeof DeviceOrientationEvent.requestPermission)throw Error("当前设备不支持权限请求");console.log("About to request permission...");let e=await DeviceOrientationEvent.requestPermission();if(console.log("Permission result:",e),"granted"===e)console.log("Permission granted, initializing compass..."),j();else throw Error("权限被拒绝: ".concat(e))}catch(e){console.error("Permission request error:",e),l("权限请求失败: ".concat(e.message)),i("denied")}};if(s)return(0,r.jsx)("div",{className:"flex flex-col items-center space-y-4",children:(0,r.jsxs)("div",{className:"compass-dial w-48 h-48 sm:w-56 sm:h-56 relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-red-500 to-red-600 rounded-full"}),(0,r.jsx)("div",{className:"absolute inset-2 bg-gradient-to-br from-red-50 to-red-100 rounded-full border-2 border-red-400 flex items-center justify-center shadow-lg",children:(0,r.jsxs)("div",{className:"text-red-700 text-sm font-medium text-center px-4",children:[(0,r.jsx)("div",{className:"mb-2",children:"⚠️"}),(0,r.jsx)("div",{className:"font-bold",children:"术法受阻"}),(0,r.jsx)("div",{className:"text-xs mt-2 opacity-90",children:s}),(0,r.jsx)("div",{className:"text-xs mt-1 opacity-70",children:"建议重新施法或换个吉时"})]})})]})});if(!n&&"undefined"!=typeof DeviceOrientationEvent&&"function"==typeof DeviceOrientationEvent.requestPermission)return(0,r.jsx)("div",{className:"flex flex-col items-center space-y-4",children:(0,r.jsxs)("div",{className:"compass-dial w-48 h-48 sm:w-56 sm:h-56 relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-full"}),(0,r.jsx)("div",{className:"absolute inset-2 bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-full border-2 border-emerald-400 flex items-center justify-center shadow-lg",children:(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-3 px-6",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-emerald-400 to-emerald-500 rounded-full flex items-center justify-center border-2 border-emerald-600 shadow-md",children:(0,r.jsx)("div",{className:"text-white text-xl",children:"\uD83D\uDD2E"})}),(0,r.jsx)("div",{className:"text-emerald-700 text-sm text-center font-bold",children:"开启天地感应"}),(0,r.jsx)("div",{className:"text-emerald-600 text-xs text-center px-2",children:"需要您的授权方可感应天地磁场，洞察方位玄机"}),(0,r.jsx)("button",{onClick:g,onTouchEnd:g,className:"bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white px-6 py-2 rounded-lg text-sm font-medium transition-all duration-200 shadow-md hover:shadow-lg active:scale-95",style:{WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:"开启罗盘术法"})]})})]})});let N=[{text:"正北",element:"水",animal:"玄武",fortune:"主智慧与财运",desc:"坎位，水之源头，主事业发展"},{text:"东北",element:"土",animal:"螣蛇",fortune:"主学业与贵人",desc:"艮位，山之稳固，利读书求学"},{text:"正东",element:"木",animal:"青龙",fortune:"主健康与成长",desc:"震位，雷之生发，利身体康健"},{text:"东南",element:"木",animal:"勾陈",fortune:"主财富与姻缘",desc:"巽位，风之流动，利财源广进"},{text:"正南",element:"火",animal:"朱雀",fortune:"主名声与事业",desc:"离位，火之光明，利功名成就"},{text:"西南",element:"土",animal:"坤德",fortune:"主家庭与母爱",desc:"坤位，地之包容，利家宅安宁"},{text:"正西",element:"金",animal:"白虎",fortune:"主收获与决断",desc:"兑位，泽之收纳，利收成决策"},{text:"西北",element:"金",animal:"天狼",fortune:"主权威与领导",desc:"乾位，天之刚健，利权势地位"}][Math.round(e/45)%8];return(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-6",children:[(0,r.jsxs)("div",{className:"compass-dial w-56 h-56 sm:w-64 sm:h-64 md:w-72 md:h-72 relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-600 to-emerald-700 rounded-full shadow-2xl"}),(0,r.jsxs)("div",{className:"absolute inset-3 bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-full border-4 border-emerald-500 shadow-xl overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-100/50 to-emerald-200/50 rounded-full"}),[0,45,90,135,180,225,270,315].map((e,t)=>(0,r.jsx)("div",{className:"absolute w-2.5 h-2.5 bg-gradient-to-br from-amber-400 to-amber-500 rounded-full border border-amber-600 shadow-md",style:{top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(".concat(e,"deg) translateY(-90px)")}},e)),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"relative w-full h-full",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center transition-transform duration-300 ease-out",style:{transform:"rotate(".concat(-h,"deg)")},children:(0,r.jsxs)("div",{className:"w-full h-full rounded-full flex items-center justify-center relative",children:[(0,r.jsxs)("div",{className:"absolute top-6 left-1/2 -translate-x-1/2 flex flex-col items-center",children:[(0,r.jsx)("div",{className:"w-2.5 h-12 bg-gradient-to-b from-red-400 to-red-600 rounded-full shadow-lg"}),(0,r.jsx)("div",{className:"w-4 h-4 bg-gradient-to-br from-red-400 to-red-600 rounded-full border-2 border-red-700 shadow-lg -mt-1"})]}),(0,r.jsx)("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex flex-col-reverse items-center",children:(0,r.jsx)("div",{className:"w-1.5 h-10 bg-gradient-to-t from-blue-400 to-blue-600 rounded-full shadow-lg"})}),(0,r.jsx)("div",{className:"absolute left-6 top-1/2 -translate-y-1/2",children:(0,r.jsx)("div",{className:"h-1.5 w-10 bg-gradient-to-r from-emerald-400 to-emerald-600 rounded-full shadow-lg"})}),(0,r.jsx)("div",{className:"absolute right-6 top-1/2 -translate-y-1/2",children:(0,r.jsx)("div",{className:"h-1.5 w-10 bg-gradient-to-l from-emerald-400 to-emerald-600 rounded-full shadow-lg"})})]})}),(0,r.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-6 h-6 bg-gradient-to-br from-amber-300 to-amber-500 rounded-full border-2 border-amber-600 shadow-lg",children:(0,r.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-2 h-2 bg-amber-200 rounded-full"})})]})})]}),(0,r.jsx)("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 text-base font-bold text-emerald-700 bg-white rounded-lg px-3 py-1.5 border-2 border-emerald-300 shadow-lg",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{children:"正北"}),(0,r.jsx)("div",{className:"text-xs opacity-70",children:"坎"})]})}),(0,r.jsx)("div",{className:"absolute -bottom-6 left-1/2 -translate-x-1/2 text-base font-bold text-emerald-700 bg-white rounded-lg px-3 py-1.5 border-2 border-emerald-300 shadow-lg",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{children:"正南"}),(0,r.jsx)("div",{className:"text-xs opacity-70",children:"离"})]})}),(0,r.jsx)("div",{className:"absolute -left-6 top-1/2 -translate-y-1/2 text-base font-bold text-emerald-700 bg-white rounded-lg px-3 py-1.5 border-2 border-emerald-300 shadow-lg",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{children:"正西"}),(0,r.jsx)("div",{className:"text-xs opacity-70",children:"兑"})]})}),(0,r.jsx)("div",{className:"absolute -right-6 top-1/2 -translate-y-1/2 text-base font-bold text-emerald-700 bg-white rounded-lg px-3 py-1.5 border-2 border-emerald-300 shadow-lg",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{children:"正东"}),(0,r.jsx)("div",{className:"text-xs opacity-70",children:"震"})]})})]}),(0,r.jsx)("div",{className:"bg-gradient-to-br from-white to-emerald-50 rounded-xl border-2 border-emerald-300 p-5 shadow-lg max-w-md",children:(0,r.jsxs)("div",{className:"text-center space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-gradient-to-br from-amber-400 to-amber-500 rounded-full"}),(0,r.jsxs)("div",{className:"text-xl font-bold text-emerald-800",children:[Math.round(e),"\xb0 ",N.text]}),(0,r.jsx)("div",{className:"w-3 h-3 bg-gradient-to-br from-amber-400 to-amber-500 rounded-full"})]}),(0,r.jsxs)("div",{className:"bg-emerald-100 rounded-lg p-3 space-y-2",children:[(0,r.jsx)("div",{className:"text-sm font-bold text-emerald-800 border-b border-emerald-300 pb-1",children:"\uD83D\uDCCD 当前方位解析"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,r.jsxs)("div",{className:"text-emerald-700",children:[(0,r.jsx)("span",{className:"font-bold",children:"五行："}),N.element]}),(0,r.jsxs)("div",{className:"text-emerald-700",children:[(0,r.jsx)("span",{className:"font-bold",children:"神兽："}),N.animal]})]}),(0,r.jsxs)("div",{className:"text-xs text-emerald-600 pt-1",children:[(0,r.jsx)("div",{className:"font-bold mb-1",children:"\uD83D\uDD2E 运势指引："}),(0,r.jsx)("div",{children:N.fortune})]}),(0,r.jsxs)("div",{className:"text-xs text-emerald-600 bg-white rounded p-2 border border-emerald-200",children:[(0,r.jsx)("div",{className:"font-bold mb-1",children:"\uD83D\uDCDC 风水解读："}),(0,r.jsx)("div",{children:N.desc})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-xs text-emerald-600",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),(0,r.jsx)("span",{children:"罗盘运转正常 \xb7 天地磁场稳定"}),(0,r.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"})]})]})})]})}}}]);